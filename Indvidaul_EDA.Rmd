
---
title: "EDA - Zero to Coke Hero"
author: "Michael Tom"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output:
  html_document:
    css: "custom-styles.css"
    theme: null
    highlight: null
    toc: true
    toc_float: false
  pdf_document:
    toc: true
---

# Introduction

## Business Problem and Analytic Approach

### Business Problem Statement for Swire Coca-Cola's Innovation Project

#### Business Problem: 

Swire Coca-Cola, a prominent leader in the beverage distribution industry across the Western US, faces the challenge of accurately timing the launch of limited edition "innovation" beverage products. Despite possessing extensive historical sales data and regularly introducing new products, Swire struggles with accurately predicting demand for these innovative, never-before-sold items. These products are pivotal for sustaining customer interest, stimulating demand, and maintaining a competitive edge. However, the risk of overproduction or underestimating demand looms, potentially leading to revenue loss or customer dissatisfaction.

#### The Benefit of a Solution: 

A precise demand forecast for Swire Coca-Cola's innovative products is imperative for the company to meet all potential demand without overproducing, thereby maximizing revenue and elevating customer satisfaction. By strategically launching the right products in suitable regions at optimal times, Swire can attain a market advantage, reinforce its position as an industry trendsetter, and foster brand loyalty among increasingly diverse consumers.

#### Success Metrics: 

The project's success will be gauged based on the accuracy of demand forecasts for the specified innovative products compared to actual sales outcomes. Success metrics encompass the model's capacity to predict location, timing, duration, and units sold for each product launch, furnishing actionable business insights that drive financial gains and amplify market share for essential flavors.

#### Analytics Approach: 

The analytics team will employ Exploratory Data Analysis (EDA) to understand the underlying patterns, Time Series Forecasting techniques (ARIMA and SARIMA models), and Machine Learning algorithms derived from over 24 million observations spanning three years of sales data. Practically, the team must also grapple with the intricacies of this significant market, which encompasses more than 3100 unique products sold across 13 western states with diverse demographics, while considering the costs associated with production overage and underage. This comprehensive approach aims to predict optimal launch periods for new products and discern the attributes and quantities contributing to successful launches. Additionally, the team will adhere to standard data science practices such as data separation into training and test sets to validate model predictions and accurately forecast demand.

#### Scope: 

The project will concentrate on crafting predictive models and generating business insights for seven specified new products. Deliverables include a PowerPoint presentation highlighting key insights, an annotated report delineating the code and model outputs, and all relevant code posted to GitHub for transparency. Future expansions may encompass tailored models for specific brands, locations, or periods to further refine forecasting accuracy.

#### Details: 

The project team comprises four analysts: Ian Donaldson, Michael Tom, Andrew Walton, and Jake Jarrard. The project is slated for completion and presentation to the client on April 11, 2024, with key milestones including exploratory data analysis completion by February 25, model building by March 24, and presentation finalization by April 10. This timeline ensures thorough analysis and model development, culminating in a comprehensive presentation of findings to Swire Coca-Cola.

#### Conclusion: 

By accurately forecasting demand for innovative limited-release beverages, Swire Coca-Cola can make informed decisions to optimize inventory levels, enhance customer satisfaction, and solidify its position as an industry leader in beverage innovation. The collaborative efforts of the analytics team will furnish Swire with the insights needed to navigate the complexities of new product launches successfully.

## Purpose of Notebook

The purpose of this EDA notebook is to identify and analyze the Swire Coca-Cola data set looking for hints and clues on guidance of forecasting innovation products in a time series format. Additional feature engineering and data cleaning will be performed to prepare the data for time series forecasting and machine learning models.

## Questions about Data to Answer

1. What are the unique features in the data set?
3. What are the data types for each feature?
4. What are the missing values in the data set?
5. Are there unique dates in the data set?
6. Are there unique products in the data set?
7. Are there unique sales territories in the data set?
8. What are Swire's unqiue innovation products (flavors, packaging, etc)?
9. What are top/bottom selling brands?
10. How do competitors stack up in terms of sales?
11. What seasons are key revenue drivers for Swire?
12. Are there intersting financial metrics?
13. How long do innovation products typically run?
14. How to identify week 0/start/tenure for each innovaiton product?

# Description of the Data

The data set is a time series data set with 24,000,000+ observations and 13 features. The data set contains sales data for Swire Coca-Cola products across 13 western states. The data set contains sales data for 3 years. The data set contains sales data for 3,100 unique products. The data set contains sales data for 13 unique sales territories. The data set contains sales data for 7 unique innovation products. The data set contains sales data for 10 unique brands. The data set contains sales data for 3 unique competitors. The data set contains sales data for 4 unique seasons. The data set contains sales data for 3 unique financial metrics. The data set contains sales data for 3 unique tenure metrics. 

# Discussion of Missing Data

The data set contains NA values for CALORIC_SEGMENT in its raw form comprising 0.2% (59725 missing values) of the data. Using text analysis on ITEM description, imputation was performed to determine the observation's CALORIC_SEGMENT as either diet/light or regular.

# Exploratory Visualizations and/or Summary Tables

```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r loada data and packages, message = FALSE, warning = FALSE}
# Load the data
df <- readRDS("swire_no_nas.rds")
#write to csv for other tools
#write.csv(df, "swire_no_nas.csv")
```

```{r load packages and set up, message = FALSE, warning = FALSE, echo = FALSE }
# Load the pacman package
if (!require("pacman")) install.packages("pacman")

# Use pacman to load (and install if necessary) the specific packages 
pacman::p_load(data.table, zoo, lubridate, tidyverse, 
               readr, skimr, ggplot2, parallel, doParallel, scales)

#set any parallel processing options
doParallel::registerDoParallel(cores = 7)


```

> Load the data, packages, and set things up.

```{r additional feature engineering beyond NA removal, message = FALSE, warning = FALSE}
#season column based on date
df <- df %>%
  mutate(MONTH = month(ymd(df$DATE)), # Extract month from the date
         SEASON = case_when(
           MONTH %in% c(12, 1, 2) ~ "WINTER",
           MONTH %in% c(3, 4, 5) ~ "SPRING",
           MONTH %in% c(6, 7, 8) ~ "SUMMER",
           MONTH %in% c(9, 10, 11) ~ "FALL",
           TRUE ~ NA_character_ 
         ))

#sales per unit
df <- df %>%
  mutate(SINGLE_PRICE = DOLLAR_SALES / UNIT_SALES)

```

> Months broken up into seasons for potential feature engineering uses, along with sales per unit.


```{r OVERVIEW, message = FALSE, warning = FALSE}
#check df class
class(df)

#check df structure
str(df)

#check df head
head(df)

#NAs
sum(is.na(df))


#skim df
skim(df)


```

> There are 59725 missing values in the original dataset. After imputing NAs based on text data (seperate steps from Jake), we are left with 0 missing values. Many features are characters and should be converted to factors. The data is not duplicated. We have 152 unique DATEs (weeks) in the data set, which indicates that there is weekly data for nearly 3 years without any fulling missing weeks. There are 2 CALORIC_SEGMENTS, diet and regular;5 CATEGORIES;  8 MANUFACTURERS; 319 BRANDS; 103 PACKAGE types; 3692 unique ITEM descriptions.



```{r fix character types, message = FALSE, warning = FALSE}
#convert date to date type
df$DATE <- as.Date(df$DATE)



#factorize
df <- df %>%
  mutate(BRAND = as.character(BRAND),
         PACKAGE = as.character(PACKAGE)) %>%
  mutate(across(c(BRAND, PACKAGE, CATEGORY, MANUFACTURER, SEASON), ~as.factor(.)))


#one hot encode CALORIC_SEGMENT as 0 or 1
df <- df %>%
mutate(across(CALORIC_SEGMENT, ~ifelse(. == "REGULAR", 1, 0)))


# Print the result
#validate data types
summary(df)

```

> After feature data type conversion, the data is ready for exploratory data analysis.

```{r unique features of brands for swire questions, message = FALSE, warning = FALSE}

#echo BRAND name and spacing
cat("\n DIET SMASH \n")

#BRAND == DIET SMASH
df %>%
  filter(BRAND == "DIET SMASH") %>%
  select(MANUFACTURER,CALORIC_SEGMENT, CATEGORY, PACKAGE, ) %>%
  summary()


#echo BRAND name and spacing
cat("\n SPARKLING JACCEPTABLETLESTER \n")

#BRAND == JACCEPTABLETESTER
df %>%
  filter(BRAND == "SPARKLING JACCEPTABLETLESTER") %>%
  select(MANUFACTURER,CALORIC_SEGMENT, CATEGORY, PACKAGE) %>%
  summary()

#echo BRAND name and spacing
cat("\n VENOMOUS BLAST \n")

#BRAND == VENOMOUS BLAST
df %>%
  filter(BRAND == "VENOMOUS BLAST") %>%
  select(MANUFACTURER,CALORIC_SEGMENT, CATEGORY, PACKAGE) %>%
  summary()

#echo BRAND name and spacing
cat("\n SQUARE \n")

#BRAND == SQUARE
df %>%
  filter(BRAND == "SQUARE") %>%
  select(MANUFACTURER,CALORIC_SEGMENT, CATEGORY, PACKAGE) %>%
  summary()

#echo BRAND name and spacing
cat("\n GREETINGLE \n")

#BRAND == GREETINGLE
df %>%
  filter(BRAND == "GREETINGLE") %>%
  select(MANUFACTURER,CALORIC_SEGMENT, CATEGORY, PACKAGE) %>%
  summary()

#echo BRAND name and spacing
cat("\n DIET MOONLIT \n")

#BRAND == DIET MOONLIT
df %>%
  filter(BRAND == "DIET MOONLIT") %>%
  select(MANUFACTURER,CALORIC_SEGMENT, CATEGORY, PACKAGE) %>%
  summary()

#echo BRAND name and spacing
cat("\n PEPPY \n")

#BRAND == PEPPY
df %>%
  filter(BRAND == "PEPPY") %>%
  select(MANUFACTURER,CALORIC_SEGMENT, CATEGORY, PACKAGE) %>%
  summary()
```
> The Diet Smash product is a diet product, in the energy category, and comes in 3 packaging types (Innovation - Packaging?). The Sparkling Jacceptabletlester brand comes in both diet/regular, straddles both sparkling water and sparkling soda drink categories, and comes in multiple different package types (but not innovation package "16small multi cup"). The Venomous Blast product comes in both diet and regular, in the energy category product, and comes in 3 packaging types (almost exclusively "16small multi cup", with two short term release sizes, but not future "innovation package?" "16 liquid small"). The Square brand comes in both diet and regular, in the 2 categories (sparkling water and ssd), and comes in 5 packaging types (several have extremely small counts - full innovation packaging?). The Greetingle brand comes in only diet, in the ING Enhanced Water category, and comes in 6 packaging types (all with relatively legit numbers, with the exception of one size). The Diet Moonlit brand comes in only diet, in the ssd category, and comes in multiple packaging types (all with legit numbers). The Peppy brand comes in only regular, in the ssd category, and comes in at least 6 packaging types (all with legit numbers, other could be explored more). 


```{r deeper sales look, message = FALSE, warning = FALSE}

# Turn off scientific notation
options(scipen = 999)


#sales in thousands by manufacturer
df %>%
  group_by(MANUFACTURER) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES)) %>%
  arrange(desc(TOTAL_SALES))

#graph sales in thousands by manufacturer

df %>%
  group_by(MANUFACTURER) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  ggplot(aes(x = reorder(MANUFACTURER, -TOTAL_SALES), y = TOTAL_SALES)) +
  geom_col() +
  coord_flip() +
  labs(title = "Total Sales in Thousands by Manufacturer",
       x = "Manufacturer",
       y = "$ Sales")

#sales in thousands by top 10 package size
df %>%
  group_by(PACKAGE) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  arrange(desc(TOTAL_SALES)) %>%
  head(10)

#graph sales in thousands by top 10 ten package size
df %>%
  group_by(PACKAGE) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  arrange(desc(TOTAL_SALES)) %>%
  head(10) %>%
  ggplot(aes(x = reorder(PACKAGE, -TOTAL_SALES), y = TOTAL_SALES)) +
  geom_col() +
  coord_flip() +
  labs(title = "Top 10 Sales in Thousands by Package Size",
       x = "Package Size",
       y = "$ Sales")

#bottom 10 sales in throusands by package size
df %>%
  group_by(PACKAGE) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES)) %>%
  arrange(TOTAL_SALES) %>%
  head(10)


#graph sales in thousands by bottom 10 package size
df %>%
  group_by(PACKAGE) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES)) %>%
  arrange(TOTAL_SALES) %>%
  head(10) %>%
  ggplot(aes(x = reorder(PACKAGE, TOTAL_SALES), y = TOTAL_SALES)) +
  geom_col() +
  coord_flip() +
  labs(title = "Bottom 10 Sales by Package Size",
       x = "Package Size",
       y = "$ Sales")

#top 10 sales in thousands by brand
df %>%
  group_by(BRAND) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  arrange(desc(TOTAL_SALES)) %>%
  head(10)

#graph sales in thousands by top 10 brand
df %>%
  group_by(BRAND) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  arrange(desc(TOTAL_SALES)) %>%
  head(10) %>%
  ggplot(aes(x = reorder(BRAND, -TOTAL_SALES), y = TOTAL_SALES)) +
  geom_col() +
  coord_flip() +
  labs(title = "Top 10 Sales in Thousands by Brand",
       x = "Brand",
       y = "$ Sales")

#bottom 10 sales in thousands by brand
df %>%
  group_by(BRAND) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES)) %>%
  arrange(TOTAL_SALES) %>%
  head(10)

#graph sales in thousands by bottom 10 brand
df %>%
  group_by(BRAND) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES)) %>%
  arrange(TOTAL_SALES) %>%
  head(10) %>%
  ggplot(aes(x = reorder(BRAND, TOTAL_SALES), y = TOTAL_SALES)) +
  geom_col() +
  coord_flip() +
  labs(title = "Bottom 10 Sales by Brand",
       x = "Brand",
       y = "$ Sales")

#sales in thousands by category
df %>%
  group_by(CATEGORY) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  arrange(desc(TOTAL_SALES))

#graph sales in thousands by CATEGORY
df %>%
  group_by(CATEGORY) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  ggplot(aes(x = reorder(CATEGORY, -TOTAL_SALES), y = TOTAL_SALES)) +
  geom_col() +
  coord_flip() +
  labs(title = "Total Sales in Thousands by Category",
       x = "Category",
       y = "$ Sales")

#sales in thousands by season
df %>%
  group_by(SEASON) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  arrange(desc(TOTAL_SALES))

#graph sales by SEASON
df %>%
  group_by(SEASON) %>%
  summarise(TOTAL_SALES = sum(DOLLAR_SALES/1000)) %>%
  ggplot(aes(x = reorder(SEASON, -TOTAL_SALES), y = TOTAL_SALES)) +
  geom_col() +
  coord_flip() +
  labs(title = "Total Sales in Thousands by Season",
       x = "Season",
       y = "$ Sales")
```

> Swire is in 3rd place for overall sales behind Jollys and Cocos for overall sales by manufacturer. The top 3 package sizes range from 12small 12one cup, 20small multi jug, and 16small multi cup. Bottom 3 sales by package size are 8.55small mlt shadyes jug, 20 small 15one jug, and 8.55small 6one shadyes jug. Bottom packges sizes are likely innovation package that did not do so well based on extremely small sales (<$40K). Bubble Joy Advantageous (a Coco's regular soda) is a clear winner in sales by brand, followed by real-time (Ally's primarily energy drink in diet/regular), and peppy (Swire-CC's regular soda). Bottom 10 sales by brand all falls into extremely small buckets of sales less than $6k, are these innovation product failures? The bottom three are Mist Twst Nat Cbry (Jolly's 1 single sale of regular soda), Tipcal Canary Twister Soda (1 single sale of Jolly's regular soda), and Vaultless (1 single sale of Coco's diet soda). The sparkling soda drink category is more than double the next (energy). ING Enhanced Water and Sparkling Water register as notable bottled drinks, but coffee barely scratches the surface in terms of sales. Summer and Spring are roughly about the same in terms of sales, followed by a slight drop in Winter, and a more noticeable drop for Fall. 



```{r brand length of time, message = FALSE, warning = FALSE}
#top 10 longest running brands
df %>%
  group_by(BRAND) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  arrange(desc(LENGTH)) %>%
  head(10)

#shortest 10 running brands
df %>%
  group_by(BRAND) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  arrange(LENGTH) %>%
  head(10)

#median length of time for a brand
df %>%
  group_by(BRAND) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  summarise(median(LENGTH))

#mean length of time for a brand
df %>%
  group_by(BRAND) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  summarise(mean(LENGTH))

#density plot of brand run time
df %>%
  group_by(BRAND) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  ggplot(aes(x = LENGTH)) +
  geom_density() +
  labs(title = "Density Plot of Brand Run Time",
       x = "Weeks",
       y = "Frequency")

#brands that run for less than 6 months
df %>%
  group_by(BRAND) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  filter(LENGTH < 26)

#summarize features of brands that run for less than 6 months
df %>%
  group_by(BRAND) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  filter(LENGTH < 6) %>%
  left_join(df, by = "BRAND") %>%
  select(BRAND, CATEGORY, SEASON, PACKAGE, MANUFACTURER) %>%
  distinct()


```

> The top 10 brands that run 148 or 152 weeks do not include some of the top sales by brands (are there missing weeks?). The top 10 shortest running brands include bottom brands by sales and only ran for 1 or two weeks, which makes sense if something only registered one single sale. The median length of a brand is 137 weeks, with mean brand run time falling in a 99.1 weeks. Therefore, the data likely exhibits left skewness, indicating that there are some brands with very short run times (which pull down the mean), while the median is higher due to the influence of some brands with longer run times. The histogram of brand run time shows a left skew with several stalwart brands running for a very long time, and a lot of brands, including innovation types, running for a shorter duration. As can be seen in the density plot there are two main humps or modes, one that clusters between 0 and ~25 weeks (6 months) trending down to a flatter line between week 50 and week 100, and another much larger cluster presumably dominated by the always on the shlef types cluster between 125 and 152 weeks. It may be worth looking for week 0/launch/tenure date spikes for those products that runs less than 6 months in order to determine start/stop times for any ARIMA/Time-Series models later.


```{r package length of time, message = FALSE, warning = FALSE}
#top 10 longest running packages
df %>%
  group_by(PACKAGE) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  arrange(desc(LENGTH)) %>%
  head(10)

#shortest 10 running packages
df %>%
  group_by(PACKAGE) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  arrange(LENGTH) %>%
  head(10)

#median length of time for a package
df %>%
  group_by(PACKAGE) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  summarise(median(LENGTH))

#mean length of time for a package
df %>%
  group_by(PACKAGE) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  summarise(mean(LENGTH))

#density plot of package run time
df %>%
  group_by(PACKAGE) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  ggplot(aes(x = LENGTH)) +
  geom_density() +
  labs(title = "Density Plot of Package Run Time",
       x = "Weeks",
       y = "Frequency")

#packages that run for less than 6 months
df %>%
  group_by(PACKAGE) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  filter(LENGTH < 26)

#summarize features of packages that run for less than 6 months
df %>%
  group_by(PACKAGE) %>%
  summarise(LENGTH = n_distinct(DATE)) %>%
  filter(LENGTH < 6) %>%
  left_join(df, by = "PACKAGE") %>%
  select(PACKAGE, CATEGORY, SEASON, BRAND, MANUFACTURER) %>%
  distinct()

```

> Top 10 packages run the entire length of the dataset, which is 152 weeks. These are tried and true packaging sizes that we have all likely grown up with, know and love to enjoy our beverages from, whether from a gas station or grocery store. The top 10 shortest packages range from 1 week to 7 weeks.  The median package run length is 147, indicating that tried and true packing overwhelmingly dominates distribution sales. The mean package tenure is 117 weeks. Therefore, the data likely exhibits right skewness, indicating that there are some packages with very high tenures (which push up the median), but the mean is lower due to the influence of some packages with shorter tenures. The density plot shows two primary modes, one smaller < 12 weeks, likely innovation dominated, and another larger > 140 weeks, legacy package sizes. There are 14 package sizes that run for less than 6 months or 26 weeks.

```{r sales by brand and distinguising characterics from Qs, message = FALSE, warning = FALSE}
#graph DOLLAR_SALES by DATE for BRAND == "DIET SMASH"
df %>%
  filter(BRAND == "DIET SMASH") %>%
  ggplot(aes(x = DATE, y = DOLLAR_SALES)) +
  geom_line() +
  labs(title = "Sales for Diet Smash",
       x = "Date",
       y = "$ Sales")

#graph DOLLAR_SALES by DATE for BRAND == "DIET SMASH" - INNOVATION PACKAGE == "2L MULTI JUG"
df %>%
  filter(BRAND == "DIET SMASH", PACKAGE == "2L MULTI JUG") %>%
  ggplot(aes(x = DATE, y = DOLLAR_SALES)) +
  geom_line() +
  labs(title = "Sales for Diet Smash 2L Multi Jug",
       x = "Date",
       y = "$ Sales")



#graph DOLLAR_SALES by DATE for BRAND == "SPARKLING JACCEPTABLETLESTER",
#CATEGORY == "SSD", CALORIC_SEGMENT == REGULAR
df %>%
  filter(BRAND == "SPARKLING JACCEPTABLETLESTER", CATEGORY == "SSD",
         CALORIC_SEGMENT == "1" ) %>%
  ggplot(aes(x = DATE, y = DOLLAR_SALES)) +
  geom_line() +
  labs(title = "Sales for Regular Sparkling Jacceptabletlester Soft Drink",
       x = "Date",
       y = "$ Sales")

#graph DOLLAR_SALES by DATE for BRAND == "VENOMOUS BLAST" and CATEGORY == DIET/LIGHT
df %>%
  filter(BRAND == "VENOMOUS BLAST", CATEGORY == "DIET/LIGHT") %>%
  ggplot(aes(x = DATE, y = DOLLAR_SALES)) +
  geom_line() +
  labs(title = "Sales for Venomous Blast",
       x = "Date",
       y = "$ Sales")

#graph DOLLAR_SALES by DATE for BRAND == "SQUARE"
df %>%
  filter(BRAND == "SQUARE") %>%
  ggplot(aes(x = DATE, y = DOLLAR_SALES)) +
  geom_line() +
  labs(title = "Sales for Square",
       x = "Date",
       y = "$ Sales")

#graph DOLLAR_SALES by DATE for BRAND == "GREETINGLE"
df %>%
  filter(BRAND == "GREETINGLE") %>%
  ggplot(aes(x = DATE, y = DOLLAR_SALES)) +
  geom_line() +
  labs(title = "Sales for Greetingle",
       x = "Date",
       y = "$ Sales")

#graph DOLLAR_SALES by DATE for BRAND == "DIET MOONLIT"
df %>%
  filter(BRAND == "DIET MOONLIT") %>%
  ggplot(aes(x = DATE, y = DOLLAR_SALES)) +
  geom_line() +
  labs(title = "Sales for Diet Moonlit",
       x = "Date",
       y = "$ Sales")

#graph DOLLAR_SALES by DATE for BRAND == "PEPPY"
df %>%
  filter(BRAND == "PEPPY") %>%
  ggplot(aes(x = DATE, y = DOLLAR_SALES)) +
  geom_line() +
  labs(title = "Sales for Peppy",
       x = "Date",
       y = "$ Sales")



```

> Some seasonlity is observed in all drinks analyzed, with most including missing weeks and spikes. Are missing weeks, missing data, end of product lifecycle, or something else? The missing period seems common to several products analyzed.

```{r missing week analysis, message = FALSE, warning = FALSE}

#What are the common gaps between DATE where there is no weekly data for BRAND == "DIET SMASH"
df %>%
  filter(BRAND == "DIET SMASH") %>%
  arrange(DATE) %>%
  mutate(DIFF = DATE - lag(DATE)) %>%
  filter(DIFF > 7) %>%
  count(DIFF) %>%
  arrange(desc(n)) %>%
  head(20)

#What are the common gaps between DATE where there is no weekly data for BRAND == "DIET SMASH" and PACKAGE == "2L MULTI JUG"
df %>%
  filter(BRAND == "DIET SMASH", PACKAGE == "2L MULTI JUG") %>%
  arrange(DATE) %>%
  mutate(DIFF = DATE - lag(DATE)) %>%
  filter(DIFF > 7) %>%
  count(DIFF) %>%
  arrange(desc(n)) %>%
  head(20)

#What are the common gaps between DATE where there is no weekly data for BRAND == "SPARKLING JACCEPTABLETLESTER",
#CATEGORY == "SSD", CALORIC_SEGMENT == REGULAR
df %>%
  filter(BRAND == "SPARKLING JACCEPTABLETLESTER", CATEGORY == "SSD",
         CALORIC_SEGMENT == 1) %>%
  arrange(DATE) %>%
  mutate(DIFF = DATE - lag(DATE)) %>%
  filter(DIFF > 7) %>%
  count(DIFF) %>%
  arrange(desc(n)) %>%
  head(20)

#What are the common gaps between DATE where there is no weekly data for BRAND == "VENOMOUS BLAST" and CALORIC_SEGMENT == DIET/LIGHT
df %>%
  filter(BRAND == "VENOMOUS BLAST", CALORIC_SEGMENT == 0 ) %>%
  arrange(DATE) %>%
  mutate(DIFF = DATE - lag(DATE)) %>%
  filter(DIFF > 7) %>%
  count(DIFF) %>%
  arrange(desc(n)) %>%
  head(20)

#What are the common gaps between DATE where there is no weekly data for BRAND == "SQUARE"
df %>%
  filter(BRAND == "SQUARE") %>%
  arrange(DATE) %>%
  mutate(DIFF = DATE - lag(DATE)) %>%
  filter(DIFF > 7) %>%
  count(DIFF) %>%
  arrange(desc(n)) %>%
  head(20)

#What are the common gaps between DATE where there is no weekly data for BRAND == "GREETINGLE"
df %>%
  filter(BRAND == "GREETINGLE") %>%
  arrange(DATE) %>%
  mutate(DIFF = DATE - lag(DATE)) %>%
  filter(DIFF > 7) %>%
  count(DIFF) %>%
  arrange(desc(n)) %>%
  head(20)

#What are the common gaps between DATE where there is no weekly data for BRAND == "DIET MOONLIT"
df %>%
  filter(BRAND == "DIET MOONLIT") %>%
  arrange(DATE) %>%
  mutate(DIFF = DATE - lag(DATE)) %>%
  filter(DIFF > 7) %>%
  count(DIFF) %>%
  arrange(desc(n)) %>%
  head(20)

#What are the common gaps between DATE where there is no weekly data for BRAND == "PEPPY"
df %>%
  filter(BRAND == "PEPPY") %>%
  arrange(DATE) %>%
  mutate(DIFF = DATE - lag(DATE)) %>%
  filter(DIFF > 7) %>%
  count(DIFF) %>%
  arrange(desc(n)) %>%
  head(20)



```

> The "Diet Smash" brand has a gap in dates of 42 days. If packaging such as "2L Multi Jug" is added in, Diet Smash has a gap of 35 days. The "regular Sparkling Jacceptabletler brand in the ssd category" has a gap of 42 days. The "Venomous Blast" brand has 2 gaps, one of 35 days and the other of 70 days. The "Square" brand has 7 gap lengths in dates, with the most common of 35 days occuring 3 times, and the longest being 126 days. The "Greetingle" brand has a single gap length of 35 days. The "Diet Moonlit" has a single gap of 42 days. The "Peppy" brand has a single gap of 42 days. Further analysis should be done to ensure start/stop dates for tenure are accurate and that we are not missing weekly data.

```{r guess as to innovation set to focus on, message = FALSE, warning = FALSE}

#most common launch DATE, end DATE, and TENURE of brand or package less than 6 months, or 26 weeks, in duration
df %>%
  group_by(BRAND, PACKAGE) %>%
  summarise(MIN_DATE = min(DATE),
            MAX_DATE = max(DATE),
            TENURE = MAX_DATE - MIN_DATE) %>%
  filter(TENURE < 26) %>%
  arrange(desc(TENURE))

#summarize top 10  brand or package less than 6 months, or 26 weeks, in duration for innovation set
df %>%
  group_by(BRAND, PACKAGE) %>%
  summarise(MIN_DATE = min(DATE),
            MAX_DATE = max(DATE),
            TENURE = MAX_DATE - MIN_DATE) %>%
  filter(TENURE < 26) %>%
  arrange(desc(TENURE)) %>%
  head(10)

#density plot of TENURE less than 6 months, or 26 weeks.
df %>%
  group_by(BRAND, PACKAGE) %>%
  summarise(MIN_DATE = min(DATE),
            MAX_DATE = max(DATE),
            TENURE = MAX_DATE - MIN_DATE) %>%
  filter(TENURE < 26) %>%
  ggplot(aes(x = TENURE)) +
  geom_density() +
  labs(title = "Density of Tenure less than 6 months",
       x = "Tenure",
       y = "Density")


```

> 145 Brand/Package sets under 6 months, with start and stop date to set as week 0. Will need to guarantee that each one is not missing week/date data for time series analysis. 9 of the top 10 brand/package sets from this set run 21 days, with the 10th running 14 days. October 7th is an extremely popular launch date. The most common tenure of the 145 brand/package combos with tenure less than 6 months run for less than 5 weeks in duration. 



# Summary and Results

> The analysis of Swire Coca-Cola's sales data reveals several key insights. Initially, there were 59,725 missing values in the dataset, which were subsequently imputed using text data analysis, resulting in zero missing values. The dataset comprises 152 unique weeks, indicating weekly data availability for nearly three years without any missing weeks. Notably, there are 2 caloric segments, 5 categories, 8 manufacturers, 319 brands, 103 package types, and 3,692 unique item descriptions.

> Examining specific products, the analysis distinguishes characteristics such as the Diet Smash product being in the energy category with three packaging types. Similarly, the Sparkling Jacceptabletlester brand offers both diet and regular options across various package types, while the Venomous Blast product is available in both diet and regular variants, primarily in the "16small multi cup" packaging. Moreover, Swire ranks third in overall sales among manufacturers, with Bubble Joy Advantageous leading in sales by brand, followed by Real-Time and Peppy.

> The data exhibits left skewness regarding brand run times, with a median of 137 weeks and a mean of 99.1 weeks, indicating varying brand durations. Conversely, package tenure demonstrates right skewness, with a median of 147 weeks and a mean of 117 weeks, suggesting longer tenure for tried and true packaging sizes. Notably, 14 package sizes run for less than six months, indicating potential innovation packages.

> Seasonal analysis reveals missing weeks and spikes across all drinks analyzed, raising questions about the cause, whether due to missing data or product lifecycle endings. Further investigation is warranted to ensure accurate start and stop dates for product tenures, particularly for brands with gaps in dates.

> In summary, the analysis provides valuable insights into Swire Coca-Cola's sales data, highlighting key trends, product characteristics, and areas for further investigation to optimize forecasting and product launch strategies.




# Modeling EDA

> This section of the EDA will focus on potential ways of breaking up the data in to modeling sets. It will check for any potential errors in the data that could cause incorrect prediction, look at sections of the data that could be removed as they will cause noise in the model and the last parts will zero in on what factors of our new inovation products are in our current data set. 

## Category Check by Item

```{r Category Check by Item, message = FALSE, warning = FALSE}
### Create table counting each item and how many brand

categories_count <- df %>%
  group_by(ITEM) %>%
  summarize(
    num_manufacturers = n_distinct(MANUFACTURER),
    num_category = n_distinct(CATEGORY),
    num_market_key = n_distinct(MARKET_KEY),
    num_caloric_segment = n_distinct(CALORIC_SEGMENT),
    num_brand = n_distinct(BRAND),
    num_package = n_distinct(PACKAGE)
  )
summary(categories_count)

categories_count %>%
  summarise(
    count_more_than_one_caloric_segment = sum(num_caloric_segment > 1),
    count_more_than_one_brand = sum(num_brand > 1),
    count_more_than_one_package = sum(num_package > 1)
  )

#88 items fall into 2 or more brands
#49 items fall into 2 or more categories
#34 Items with 2 or more packages

 df %>%
  inner_join(categories_count %>% 
                group_by(ITEM) %>%
                filter(sum(num_brand) > 1) %>%
                select(ITEM),
            by = "ITEM") %>%
   select(ITEM, BRAND) %>%
   arrange(ITEM) %>%
   distinct(ITEM, BRAND) %>%
   head(5)

# This DF shows that many of the items with 2 types of brand are both in Diet and Regular category. If we are using these items as filters in our model building we will need to remember this.
   
df %>%
  inner_join(categories_count %>% 
                group_by(ITEM) %>%
                filter(sum(num_caloric_segment) > 1) %>%
                select(ITEM),
            by = "ITEM") %>%
   select(ITEM, CALORIC_SEGMENT) %>%
   arrange(ITEM) %>%
   distinct(ITEM, CALORIC_SEGMENT) %>%
   head(5)

# As with the brand caloric segment has the same duplicate items in both segments. We will need to remember this in modeling
 
df %>%
  inner_join(categories_count %>% 
                group_by(ITEM) %>%
                filter(sum(num_package) > 1) %>%
                select(ITEM),
            by = "ITEM") %>%
   select(ITEM, PACKAGE) %>%
   arrange(ITEM) %>%
   distinct(ITEM, PACKAGE) %>%
   head(5)
 
#Even though these items have a package in the item description we their packaging category changes 
```

>In this section we see that there are products that fall into multiple Caloric Segments, Brands and Packages. We will need to keep these items in mind when building models. When creating our samller data sets for modeling we will want to assure that we filter by these 3 categories. 

## Breaking out Items by Tenure

```{r Create Sales Summary by Tenure Group, message = FALSE, warning = FALSE}
#Create table to summarize total sale days

sales_summary <- df %>%
  group_by(ITEM) %>%
  summarize(first_date = min(DATE), last_date = max(DATE), total_sales = sum(UNIT_SALES), total_revenue = sum(DOLLAR_SALES), total_sale_days = n_distinct(DATE))

#Calculate Total window of days sold

sales_summary <- sales_summary %>%
  mutate(
        duration_days = last_date - first_date,
        duration_weeks = ceiling(as.numeric(duration_days) / 7),
        launch13week_date =first_date + lubridate::weeks(13),
        launch6month_date = first_date + months(6),
        launch1year_date = first_date + lubridate::years(1),
        avg_sales_per_week = ifelse(duration_weeks == 0, total_sales, total_sales / duration_weeks),
)

#Batch data in to categories 1 day sales, upto 13 week sales, 13 week to 6 months, 6 months to a year, more than a year = ongoing

sales_summary$sales_category <- cut(sales_summary$duration_weeks, breaks = c(-Inf, 0, 13, 26, 52, Inf), 
                         labels = c("One Day Sales", "13 Week Sales", "6 Month Sales", "1 Year Sales", "Ongoing"))

# Create plot couting unique itmes in each sales category

ggplot(sales_summary, aes(x = sales_category)) +
  geom_bar() +
  geom_text(aes(label = after_stat(count)), stat = "count", vjust = 1.5, colour = "white")+
  labs(title = "Count of Items in Sales Category",
       x = "Category",
       y = "Count")
```

> In the section above we added sales summeries to our items. We see that when breaking up our itmes into sales groups we have a majority of ites that are ongoing. These will most likely not be helpful when running our 7 questions based around limited sales. 


```{r Look at Differences in Sales by Group, message = FALSE, warning = FALSE}
#Create plot of sales category with average weekly sales 

sales_summary %>%
filter(sales_category != "Ongoing") %>%
ggplot( aes(x = avg_sales_per_week, y = sales_category, color = sales_category)) +
  geom_point() +
  labs(title = "Average Weekly Sales by Sales Category",
       x = "Average Weekly Sales",
       y = "Sales Category",
       color = "Sales Category")

```

>This plot shows us that in our short sale items we are highly weighted to the left with a few large outliars when creating our modeling sets we will want to do more outliar analysis on each group to see how to address each one. 

```{r Sales by Group From Launch Date, message = FALSE, warning = FALSE}
df <- left_join(df,sales_summary %>% select(ITEM, sales_category, duration_days, duration_weeks, total_sale_days, first_date, launch13week_date, launch6month_date, launch1year_date), by = "ITEM")

# Calculate days since launch

df <- df %>%
  mutate(days_since_launch = as.numeric(DATE - first_date),
         weeks_since_launch = ceiling(as.numeric((DATE - first_date)/7)))

# Group by sales category and create separate line graphs for each sales category

df %>%
  group_by(sales_category, weeks_since_launch) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  group_by(sales_category) %>%
  filter(total_unit_sales > 0) %>%
ggplot( aes(x = weeks_since_launch, y = total_unit_sales)) +
  geom_line() +
  labs(title = "Total Unit Sales by Weeks Since Launch",
       x = "Weeks Since Launch",
       y = "Total Unit Sales") +
  facet_wrap(~ sales_category, scales = "free")
```

> In these 5 line graphs we are given the shape of sales from launch date. We see that with the short temr porducts we see a large spike at the start that tapers off as time goes on. With the ongoing products they start strong and then slowly start to fall over time. 
This demenstrates further that when modeling breaking our items into categories to model will help us be more accurate when looking at forecasting newe products for shorter amounts of time. It also reinforces that we should be able to exclude our ongoing products from the data. 

```{r Sales by Group During Time of Year, message = FALSE, warning = FALSE}

# Group by sales category and create separate line graphs
df %>%
  mutate(week_of_year = week(DATE)) %>%
  group_by(sales_category, week_of_year) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  group_by(sales_category) %>%
  filter(total_unit_sales > 0) %>%
ggplot(aes(x = week_of_year, y = total_unit_sales)) +
  geom_line() +
  labs(title = "Total Unit Sales by Week of the Year",
       x = "Week of the Year",
       y = "Total Unit Sales") +
  facet_wrap(~ sales_category, scales = "free_y")
```

> These graphs show us when forecasting for specific weeks of the year we will have large amounts of variance based on past sales. We may need to look at outliears in the 13 week and 1 year category. 


## Question 1 Parameters

Item Description: Diet Smash Plum 11Small 4One
Caloric Segment: Diet
Market Category: SSD
Manufacturer: Swire-CC
Brand: Diet Smash
Package Type: 11Small 4One
Flavor: ‘Plum’
Which 13 weeks of the year would this product perform best in the market? What is the forecasted demand, in weeks, for those 13 weeks?

```{r Q1 First Look, message = FALSE, warning = FALSE}
library(stringr)
# Matching parameters for Q1
df %>%
  filter(sales_category == "13 Week Sales", 
         CALORIC_SEGMENT == 0, 
         CATEGORY == "SSD") %>% 
         #str_detect(ITEM, "PLUM")) %>%
  group_by(ITEM) %>%
  summarize(distinct_items = n_distinct(ITEM))

# There are 37 items that match time period caloric segment, category. flavor and packaging dont exist

df %>%
  filter(str_detect(ITEM, "PLUM")) %>%
  summarize(distinct_items = n_distinct(ITEM))

#64 Plum Flavored items

#Distribution of matching items
df %>%
  filter(sales_category == "13 Week Sales", 
         CALORIC_SEGMENT == 0, 
         CATEGORY == "SSD") %>%
  group_by(ITEM, weeks_since_launch) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  ggplot(aes(x = weeks_since_launch, y = total_unit_sales)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Unit Sales by Week Since Launch",
       x = "Week Since Launch",
       y = "Total Unit Sales")

# Create Sales Category distribution of plum items
df %>%
  filter(str_detect(ITEM, "PLUM")) %>%
  group_by(sales_category) %>%
  summarize(distinct_items = n_distinct(ITEM)) %>%
  ggplot(aes(x = sales_category, y = distinct_items)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = distinct_items), vjust = -.5, color = "black") +
  labs(title = "Count Distinct Items by Sales Category With Plum Flavor",
       x = "Sales Category",
       y = "Count of Distinct Items")
  
```

>In this we found that there is a potential 37 itmes that have matching paramaters minus the flavor and packageing size. There are no itmes with the package size and 64 total plum flavored items. 

## Question 2 Parameters

Item Description: Sparkling Jacceptabletlester Avocado 11Small MLT
Caloric Segment: Regular
Market Category: SSD
Manufacturer: Swire-CC
Brand: Sparkling Jacceptabletlester
SPARKLING JACCEPTABLETLESTER
Package Type: 11Small MLT
Flavor: ‘Avocado’
Swire plans to release this product 2 weeks prior to Easter and 2 weeks post Easter. What will the forecasted demand be, in weeks, for this product?


```{r Q2 First Look, message = FALSE, warning = FALSE}

# Matching parameters for Q2
df %>%
  filter(
         month(first_date) %in% c(3, 4), 
         CALORIC_SEGMENT == 1, 
         CATEGORY == "SSD") %>% 
         #str_detect(ITEM, "AVOCADO") %>%
  summarize(distinct_items = n_distinct(ITEM))

#148 items match launching in either March or April, regular and SSD category. There are non with Avocado in this group 

df %>%
  filter(str_detect(ITEM, "AVOCADO")) %>%
  summarize(distinct_items = n_distinct(ITEM))

#340 AVOCADO Flavored items

#Distribution of matching items

df %>%
  filter(
         month(first_date) %in% c(3, 4), 
         CALORIC_SEGMENT == 1, 
         CATEGORY == "SSD",
         sales_category != 'Ongoing') %>% 
  group_by(ITEM, days_since_launch) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  ggplot(aes(x = days_since_launch, y = total_unit_sales)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Unit Sales from Launch Date of Q2 Matching Products",
       x = "Days Since Launch",
       y = "Total Unit Sales")

# Create Sales Category distribution of AVACADO items

df %>%
  filter(str_detect(ITEM, "AVOCADO")) %>%
  group_by(sales_category) %>%
  summarize(distinct_items = n_distinct(ITEM)) %>%
  ggplot(aes(x = sales_category, y = distinct_items)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = distinct_items), vjust = -.5, color = "black") +
  labs(title = "Distinct Items by Sales Category with AVOCADO Flavor",
       x = "Sales Category",
       y = "Count of Distinct Items")
  
```

> From this section we are able to find a group of 148 items that launched either in March or April that have some of the matching features of product 2. We also have a much larger group or products that have avocado with 340 itmes. 

## Question 3 Parameters

Item Description: Diet Venomous Blast Energy Drink Kiwano 16 Liquid Small
Caloric Segment: Diet
Market Category: Energy
Manufacturer: Swire-CC
Brand: Venomous Blast
Package Type:  16 Liquid Small
Flavor: ’Kiwano’
Which 13 weeks of the year would this product perform best in the market? What is the forecasted demand, in weeks, for those 13 weeks?

```{r Q3 First Look, message = FALSE, warning = FALSE}
# Matching parameters for Q3

df %>%
  filter(
    sales_category == "13 Week Sales", 
    CALORIC_SEGMENT == 0, 
    CATEGORY == "ENERGY",
    #BRAND == "VENOMOUS BLAST",
    #str_detect(ITEM, "KIWANO")
  ) %>%
  group_by(ITEM) %>%
  summarize(distinct_items = n_distinct(ITEM))

# There are only 16  items that match time period caloric segment, category. flavor, packaging and brand dont exist

df %>%
  filter(str_detect(ITEM, "KIWANO")) %>%
  summarize(distinct_items = n_distinct(ITEM))

#76 Kiwano Flavored items

#Distribution of matching items

df %>%
  filter(sales_category == "13 Week Sales", 
         CALORIC_SEGMENT == 0, 
         CATEGORY == "ENERGY") %>%
  group_by(ITEM, weeks_since_launch) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  ggplot(aes(x = weeks_since_launch, y = total_unit_sales)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Unit Sales by Week Since Launch",
       x = "Week Since Launch",
       y = "Total Unit Sales")

# Create Sales Category distribution of Kiwano items

df %>%
  filter(str_detect(ITEM, "KIWANO")) %>%
  group_by(sales_category) %>%
  summarize(distinct_items = n_distinct(ITEM)) %>%
  ggplot(aes(x = sales_category, y = distinct_items)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = distinct_items), vjust = -.5, color = "black") +
  labs(title = "Count Distinct Items by Sales Category With Kiwano Flavor",
       x = "Sales Category",
       y = "Count of Distinct Items")
  
```

> In this section we find that there is signficatnly less data around energy drinks that match our category. Overall there is 76 current historical KIWANO flavored items with only 3 of those being sold for more than one day but less than 13 weeks. 

## Question 4 Parameters

Item Description: Diet Square Mulberries Sparkling Water 10Small MLT
Caloric Segment: Diet
Market Category: Sparkling Water
Manufacturer: Swire-CC
Brand: Square
Package Type: 10Small MLT
Flavor: ‘Mulberries
 Swire plans to release this product for the duration of 1 year but only in the Northern region. What will the forecasted demand be, in weeks, for this product?
 
```{r Q4 First Look, message = FALSE, warning = FALSE}
# Matching parameters for Q4

df %>%
  filter(
         sales_category == "1 Year Sales", 
         CALORIC_SEGMENT == 0, 
         CATEGORY == "SPARKLING WATER") %>%
         #str_detect(ITEM, "MULBERRIES")) %>%
  summarize(distinct_items = n_distinct(ITEM))

#34 items match 1 year launch sales, diet and Sparkling Water category. There are non with Mulberries in this group 

df %>%
  filter(str_detect(ITEM, "MULBERRIES")) %>%
  summarize(distinct_items = n_distinct(ITEM))

#26 Mulberries Flavored items

#Distribution of matching items

df %>%
  filter(
         sales_category == "1 Year Sales", 
         CALORIC_SEGMENT == 0, 
         CATEGORY == "SPARKLING WATER",
         sales_category != 'Ongoing') %>% 
  group_by(ITEM, days_since_launch) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  ggplot(aes(x = days_since_launch, y = total_unit_sales)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Unit Sales from Launch Date of Q4 Matching Products",
       x = "Days Since Launch",
       y = "Total Unit Sales")

# Create Sales Category distribution of Mulberries items

df %>%
  filter(str_detect(ITEM, "MULBERRIES")) %>%
  group_by(sales_category) %>%
  summarize(distinct_items = n_distinct(ITEM)) %>%
  ggplot(aes(x = sales_category, y = distinct_items)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = distinct_items), vjust = -.5, color = "black") +
  labs(title = "Distinct Items by Sales Category with Mulberry Flavor",
       x = "Sales Category",
       y = "Count of Distinct Items")
```

> In this section as with the energy drinks, we find there is much less data around sparkling water with only 34 items matching category, segment and sales category. We will need to add in demographic data for just sales in the norther region when setting up modeling. Also, of intreset there currently has been no Mulberry products placed on the market for only 1 year. 

 ## Question 5 Parameters
 
 Item Description: Greetingle Health Beverage Woodsy Yellow .5L 12One Jug
Caloric Segment: Regular
Market Category: ING Enhanced Water
Manufacturer: Swire-CC
Brand: Greetingle 
Package Type: .5L 12One Jug
Flavor: ‘Woodsy Yellow’ 
Swire plans to release this product for 13 weeks, but only in one region. Which region would it perform best in? 

```{r Q5 First Look, message = FALSE, warning = FALSE}
# Matching parameters for Q5

df %>%
  filter(
    #sales_category == "13 Week Sales", 
    CALORIC_SEGMENT == 1, 
    CATEGORY == "ING ENHANCED WATER",
    #BRAND == "GREETINGLE",
    #str_detect(ITEM, "WOODSY YELLOW")
  ) %>%
  group_by(ITEM) %>%
  summarize(distinct_items = n_distinct(ITEM))

# There are only 55 items that match Caloric Segment and Category. This one the sales cateogry also does not have matches. 

df %>%
  filter(str_detect(ITEM, "WOODSY YELLOW")) %>%
  summarize(distinct_items = n_distinct(ITEM))

#0 Flavored items

#Distribution of matching items

df %>%
  filter(#sales_category == "13 Week Sales", 
         CALORIC_SEGMENT == 1, 
         CATEGORY == "ING ENHANCED WATER") %>%
  group_by(ITEM, weeks_since_launch) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  ggplot(aes(x = weeks_since_launch, y = total_unit_sales)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Unit Sales by Week Since Launch",
       x = "Week Since Launch",
       y = "Total Unit Sales")

```

> This product proved to be the least common to our current data. The enhanced water segement is very small and has not had any limited releases like this before. Also there has been no sales of this flavor in the past. This will be one where our estimate will have many larget assumptions especially once we bring in the Demographic of only selling in one region. 

## Question 6 Parameters

Item Description: Diet Energy Moonlit Casava 2L Multi Jug
Caloric Segment: Diet
Market Category: Energy
Manufacturer: Swire-CC
Brand: Diet Moonlit
Package Type: 2L Multi Jug
Flavor: ‘Cassava’
Swire plans to release this product for 6 months. What will the forecasted demand be, in weeks, for this product?


```{r Q6 First Look, message = FALSE, warning = FALSE}
# Matching parameters for Q6
df %>%
  filter(
         sales_category == "6 Month Sales", 
         CALORIC_SEGMENT == 0, 
         CATEGORY == "ENERGY"
         #str_detect(ITEM, "CASSAVA")
         ) %>%
  summarize(distinct_items = n_distinct(ITEM))

#10 items match 6 Month launch sales, diet and Energy category. There are non with Cassava in this group 

df %>%
  filter(str_detect(ITEM, "CASSAVA")) %>%
  summarize(distinct_items = n_distinct(ITEM))

# 0 Cassava Flavored items

#Distribution of matching items

df %>%
  filter(
         sales_category == "6 Month Sales", 
         CALORIC_SEGMENT == 0, 
         CATEGORY == "ENERGY",
         sales_category != 'Ongoing') %>% 
  group_by(ITEM, days_since_launch) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  ggplot(aes(x = days_since_launch, y = total_unit_sales)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Unit Sales from Launch Date of Q6 Matching Products",
       x = "Days Since Launch",
       y = "Total Unit Sales")


# Distribution of Sales by month of the year

df %>%
  filter(
         sales_category == "6 Month Sales", 
         CALORIC_SEGMENT == 0, 
         CATEGORY == "ENERGY",
         sales_category != 'Ongoing') %>% 
  group_by(ITEM, MONTH) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  ggplot(aes(x = MONTH, y = total_unit_sales)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Unit Sales of 6 Month Sales by Month of the Year",
       x = "MONTH",
       y = "Total Unit Sales")


```

> This product grouping as with the last will need to be built on many assuptions. There currently is no other products with CASSAVA in the market. There are 10 itmes that have been sold for 6 months at a time that are in the energy drink category. For this we will need to expand out our data set to hone in on which 6 months of the year would be best. In a graph of sales we do see a window of time that these matching products have sold the most, Feb - July. 

## Question 7 Parameters

Item Description: Peppy Gentle Drink Pink Woodsy .5L Multi Jug
Caloric Segment: Regular
Type: SSD
Manufacturer: Swire-CC
Brand: Peppy
Package Type: .5L Multi Jug
Flavor: ‘Pink Woodsy’
Swire plans to release this product in the Southern region for 13 weeks. What will the forecasted demand be, in weeks, for this product?

```{r Q7 First Look, message = FALSE, warning = FALSE}
# Matching parameters for Q3

df %>%
  filter(
    sales_category == "13 Week Sales", 
    CALORIC_SEGMENT == 1, 
    CATEGORY == "SSD",
    #BRAND == "PEPPY",
    #str_detect(ITEM, "PINK WOODSY")
  ) %>%
  group_by(ITEM) %>%
  summarize(distinct_items = n_distinct(ITEM))

# There are 62 items that match time period caloric segment, category. flavor, packaging and brand combination do not exist

df %>%
  filter(str_detect(ITEM, "PINK WOODSY")) %>%
  summarize(distinct_items = n_distinct(ITEM))

#0 items have Pink Woodsy Flavored items

#Distribution of matching items

df %>%
  filter(sales_category == "13 Week Sales", 
         CALORIC_SEGMENT == 1, 
         CATEGORY == "SSD") %>%
  group_by(ITEM, weeks_since_launch) %>%
  summarize(total_unit_sales = sum(UNIT_SALES)) %>%
  ggplot(aes(x = weeks_since_launch, y = total_unit_sales)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Unit Sales by Week Since Launch",
       x = "Week Since Launch",
       y = "Total Unit Sales"
  )

```

> This product does have more compariable data since it is in the SSD category. We should be able to create a good data set once linked with the region data around a 13 week forecast. The distribution of the 13 week sales products in the SSD category follows the general distribution with large sales in week 0 and 1 very small sales in the middle and a bump in the final weeks. 



# Summary
>In this section, we conducted an extensive analysis of our modeling datasets, considering various factors that may impact our modeling outcomes. We encountered several considerations, including the presence of items falling into multiple categories and the need to filter out irrelevant categories. Particularly noteworthy was the potential advantage of discarding ongoing sales data, as these products may introduce unnecessary noise into our models. Our analysis of sales tenure distributions revealed significant differences across categories, emphasizing the importance of understanding these variations in our modeling efforts.

> One significant aspect of our analysis was the examination of sales distributions throughout the year, highlighting substantial variations between product groups and months. This temporal variation is expected to be a crucial variable in our modeling endeavors.

> Furthermore, we explored the challenges associated with modeling our innovation products. We discovered limited data points meeting the criteria for these products, with some featuring unique flavors that have never been sold before and others representing entirely new product types within specific selling categories (e.g., 13 weeks, 6 months, 1 year). These initial findings shed light on the potential challenges and opportunities in accurately modeling these innovative products.

> In conclusion, our analysis provides valuable insights into the complexities of our datasets and the considerations necessary for effective modeling. Moving forward, we will leverage these insights to refine our modeling approaches and develop more accurate predictive models.


```{r}
stopImplicitCluster()
```
